// Generated by CoffeeScript 1.6.3
(function() {
  var onReady;

  window.game = {
    onload: function() {
      if (!me.video.init("screen", 640, 480, true, "auto")) {
        alert("Your browser does not support HTML5 canvas.");
        return;
      }
      if (document.location.hash === "#debug") {
        window.onReady(function() {
          return me.plugin.register.defer(debugPanel, "debug");
        });
      }
      me.audio.init("mp3,ogg");
      me.input.registerPointerEvent("mousemove", me.game.viewport, function(e) {
        return game.mouseTarget = {
          x: e.gameWorldX,
          y: e.gameWorldY
        };
      });
      me.loader.onload = this.loaded.bind(this);
      me.loader.preload(window.game.resources);
      return me.state.change(me.state.LOADING);
    },
    loaded: function() {
      me.state.set(me.state.PLAY, new game.PlayScreen());
      me.entityPool.add("mainBunny", game.BunnyEntity, true);
      me.entityPool.add('toast', game.ToastEntity, true);
      this.defineKeys();
      return me.state.change(me.state.PLAY);
    },
    defineKeys: function() {
      me.input.bindKey(me.input.KEY.A, "left");
      me.input.bindKey(me.input.KEY.D, "right");
      me.input.bindKey(me.input.KEY.SPACE, "jump", true);
      me.input.bindKey(me.input.KEY.P, "shoot", true);
      return me.input.bindMouse(me.input.mouse.LEFT, me.input.KEY.P);
    }
  };

  window.onReady(onReady = function() {
    return window.game.onload();
  });

}).call(this);
